<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

{% extends 'base.html' %}
{% block content %}

<h1> Experience With HIV <h1>
<div class="container d-flex flex-wrap flex-row " id= "card-container"> </div>
<button class= "btn-create"><a href="/experience/experience-form">Add Experience</a></button>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<script>
    function showJson(){
        $.get("/experience/json/", function(data){
            for(i = 0; i < data.length; i++){
                addText(data[i].fields.title, data[i].fields.preview, data[i].fields.date, data[i].fields.pk)
            }
        })
    }

    $(document).ready(function(){
        showJson();
        makeCards();
    })

    function makeCards(){
        let text= "";
        $.ajax({
            url: "{% url 'homepage:Experience:show_experience_json' %}",
            type: "GET",
            dataType: "json",
            success: function(data){
                for(let experience of data){
                    text+= `<div class= "col s12 m4">
                        <div class="card">
                            <div class="card-content">
                                <span class="card-title"> ${experience.fields.title}</span>
                                <p> ${experience.fields.preview} </p>
                                <p> ${experience.pk}</p>
                            </div>
                            <div class= "card-action">
                                <a href="experience-detail/${experience.pk}"> Read More </a>
                            </div>
                        </div>
                    </div>`

                }
                $('#card-container').html(text);

            } ,
            error: function(data){
                console.log('Error Detected');
            }
    })}
</script>
{% endblock content %}
